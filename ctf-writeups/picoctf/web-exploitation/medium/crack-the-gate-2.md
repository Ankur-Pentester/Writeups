# Crack the Gate 2

#### Challenge :&#x20;

<figure><img src="../../../../.gitbook/assets/image (125).png" alt=""><figcaption></figcaption></figure>



Lets Start !

Let's begin. We are provided with a login page and a valid email address: `ctf-player@picoctf.org`. and Password List .Our first step is to analyze the login interface and attempt to identify any weaknesses or bypass techniques that may allow us to access the portal.

<figure><img src="../../../../.gitbook/assets/image (126).png" alt=""><figcaption></figcaption></figure>

Let’s capture the login request in Burp Suite using the valid email address `ctf-player@picoctf.org` and a random password such as `test`. After sending the request, the application responds with a **“Too many failed attempts”** error, indicating that a rate-limiting mechanism is in place.

<figure><img src="../../../../.gitbook/assets/image (127).png" alt=""><figcaption></figcaption></figure>

I added the `X-Forwarded-For: 127.0.0.1` header to the request, using the localhost IP, and sent the request again through Burp Suite. This time, the server responded with a **200 OK** status, indicating that the request was processed successfully.

<figure><img src="../../../../.gitbook/assets/image (128).png" alt=""><figcaption></figcaption></figure>

I sent the request again using the same `X-Forwarded-For: 127.0.0.1` header. However, this time the application returned the rate-limit error again, indicating that repeated requests from the same spoofed IP are still being tracked.

<figure><img src="../../../../.gitbook/assets/image (129).png" alt=""><figcaption></figcaption></figure>

I then updated the `X-Forwarded-For` header to `127.0.0.2`, incrementing the IP address from the previous request. This time, the request was successful. From this, I understood that the web server applies rate limiting based on the client IP address, and incrementing the IP value for each request is an effective way to bypass the restriction.

<figure><img src="../../../../.gitbook/assets/image (130).png" alt=""><figcaption></figcaption></figure>

The challenge provided a password wordlist, which I reviewed using `cat passwords.txt`.\
To automate IP rotation for bypassing the rate limit, I also created a numeric wordlist from **1 to 20** using the `seq` command. This list was later used to increment the `X-Forwarded-For` header value during the brute-force attack.

`seq 1 20 > num.txt`

<figure><img src="../../../../.gitbook/assets/image (131).png" alt=""><figcaption></figcaption></figure>

Using ffuf in pitchfork mode, I combined the password wordlist with a numeric wordlist to rotate the `X-Forwarded-For` header on every request. This approach effectively bypassed the IP-based rate limiting and enabled successful password brute forcing.

{% code overflow="wrap" %}
```
ffuf -u http://amiable-citadel.picoctf.net:60964/login -d '{"email":"ctf-player@picoctf.org","password":"FUZZ2"}' -w passwords.txt:FUZZ2 -H "X-Forwarded-For: 127.0.0.FUZZ1" -w num.txt:FUZZ1 -X POST -mc all -mode pitchfork -H "Content-Type: application/json"
```
{% endcode %}

<figure><img src="../../../../.gitbook/assets/image (132).png" alt=""><figcaption></figcaption></figure>

I then analyzed the responses and identified the request with the **largest response size**, which indicated a successful login attempt compared to the other responses.

<figure><img src="../../../../.gitbook/assets/image (133).png" alt=""><figcaption></figcaption></figure>

Using the identified credentials (`ctf-player@picoctf.org` / `axTtBLvc`), I logged into the application successfully and retrieved the flag.

<figure><img src="../../../../.gitbook/assets/image (134).png" alt=""><figcaption></figcaption></figure>

`Flag : picoCTF{xff_byp4ss_brut3_3b2dc94d}`
