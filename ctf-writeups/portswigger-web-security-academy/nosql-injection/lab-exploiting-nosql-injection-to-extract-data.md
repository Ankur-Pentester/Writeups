---
description: >-
  To solve the lab, extract the password for the administrator user, then log in
  to their account.  You can log in to your own account using the following
  credentials: wiener:peter.
---

# Lab: Exploiting NoSQL injection to extract data

First Login With Given Credential and Capture The All Trafic On Burpsuite !!

<figure><img src="../../../.gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>

We Find  Interesting Js File `/user/lookup?user=${}`  We Find Some Endpoint Where We See any User Data Just Puting His Username !!

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

In Burp, go to **Proxy > HTTP history**. Right-click the `GET /user/lookup?user=wiener` request and select **Send to Repeater**.

<figure><img src="../../../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

We Put `Carlos` In `User` Parameter and It's Return The Data of The Carlos User !!

<figure><img src="../../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

They also Work In `Administator` Username !!

<figure><img src="../../../.gitbook/assets/image (4) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

We Put Single Quotes `'` To Break The Query and It's Work !!

<figure><img src="../../../.gitbook/assets/image (5) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Then We Use Some Boolean Based Attack To Confirm The NoSql Injection  `administrator' && '1'=='1` and This Query Is Always True That's Why They Return Our Username !!

<figure><img src="../../../.gitbook/assets/image (6) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

When We Inject The Boolean False Statement and They Return Error !!

<figure><img src="../../../.gitbook/assets/image (7) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Change the user parameter to `administrator' && this.password.length < 30 || '1'=='2`, then send the request.

Make sure to URL-encode the payload. Notice that the response retrieves the account details for the `administrator` user. This indicates that the condition is true because the password is less than 10 characters.

<figure><img src="../../../.gitbook/assets/image (8) (1) (1).png" alt=""><figcaption></figcaption></figure>

* Reduce the password length in the payload, then resend the request.
* Continue to try different lengths.
* Notice that when you submit the value `9`, you retrieve the account details for the `administrator` user, but when you submit the value `8`, you receive an error message because the condition is false. This indicates that the password is 8 characters long.

<figure><img src="../../../.gitbook/assets/image (9) (1) (1).png" alt=""><figcaption></figcaption></figure>

Change the user parameter to `administrator' && this.password[ยง0ยง]=='ยงaยง`. and Send The Request and We Got Error Because  This Query Help To Find The Password In The Form of Array and Test The all Letters and Numbers and Increase The Value Of The Array and Send This Until We Got The Password That Why We Use Burp Intruder !!

<figure><img src="../../../.gitbook/assets/image (10) (1).png" alt=""><figcaption></figcaption></figure>

We Send The Request In Intruder and Paste The all alphabet Letter's and Then We Start Attack !!

<figure><img src="../../../.gitbook/assets/image (11).png" alt=""><figcaption></figcaption></figure>

We Find The First Letter of The administrator password !!

<figure><img src="../../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

Then We Increase The array Value 0 -> 1 and Then Attack Start Again We Get Second Letter of The administrator  password  !!

<figure><img src="../../../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

We Use Intruder 8 Times and We Got Full Password  `nhfpnhne`  !!

Let's Login To The administrator account using The Password !!

<figure><img src="../../../.gitbook/assets/image (454).png" alt=""><figcaption></figcaption></figure>
