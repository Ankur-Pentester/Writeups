---
description: >-
  To solve the lab, log into the application as the administrator user.  You can
  log in to your own account using the following credentials: wiener:peter.
---

# Lab: Exploiting NoSQL operator injection to bypass authentication

First We Login Using Given Credentials  !!

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

In Burp, go to **Proxy > HTTP history**. Right-click the `POST /login` request and select **Send to Repeater**.

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Send The Request and We Got `302 Found`  and We also able to See The `Location: /my-account?id=wiener` With Username !!

<figure><img src="../../../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

We Use The `$ne` operator To Pass The value To `null` When username of wiener is Not Equal to The `Null` Then We Bypass The Authentication !!

```json
{
"username":wiener,
"password":{"$ne":null}
}
```

<figure><img src="../../../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Same We Use With Carlos !!

```json
{
"username":carlos,
"password":{"$ne":null}
}
```

<figure><img src="../../../.gitbook/assets/image (4) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

But When We Use same With `administrator` but This means There is no username like We Use !!

<figure><img src="../../../.gitbook/assets/image (5) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Then We Use The `$regex` Operator and Regex Work is They Find The Similar Name We Wanna Find !!

Finally We Got The Username In The Response Tab `Location: /my-account?id=adminbh8numpj`

```json
{
"username":{"$regex":"^a"},
"password":{"$ne":null}
}
```

<figure><img src="../../../.gitbook/assets/image (6) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

We Open The `Developer Tool > Storage` and We Change The Cookie of Admin !!

<figure><img src="../../../.gitbook/assets/image (7) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

When We Change The Cookie and Reload The Website We Finally Login as `Administrator` Account !!

<figure><img src="../../../.gitbook/assets/image (8) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>
