---
description: >-
  This lab contains a password reset mechanism. Although it doesn't contain a
  race condition, you can exploit the mechanism's broken cryptography by sending
  carefully timed requests.
---

# Lab: Exploiting time-sensitive vulnerabilities

To solve the lab:

1. Identify the vulnerability in the way the website generates password reset tokens.
2. Obtain a valid password reset token for the user `carlos`.
3. Log in as `carlos`.
4. Access the admin panel and delete the user `carlos`.

You can log into your account with the following credentials: `wiener:peter`.



Let's Use Forget Password Functionality Use and Capture The All Traffic To The Burpsuite !!

<figure><img src="../../../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

Then i make a Group of Two Request first is wiener user and second user is carlos and Send It and Check The Response Time Both Request  Response Time is so different  it's Mean They Tide With Cookie Let's Use diffrent Cookie in carlos user !!

<figure><img src="../../../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

Then I Send The Get Request in `/forget-password`  endpoint but i remove the cookie first and then i send the request and we got the new cookie and new CSRF  and i paste the both cookie and CSRF  in carlos user request  and Then i send The Request and Check The Email Server and Click The First Link !!

<figure><img src="../../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

Change The Username Wiener To Carlos In url  and Set The Carlos password !!

<figure><img src="../../../.gitbook/assets/image (4) (1).png" alt=""><figcaption></figcaption></figure>

Login using carlos password and visit the admin panel and delete the user carlos  !!

<figure><img src="../../../.gitbook/assets/image (5) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (6) (1).png" alt=""><figcaption></figcaption></figure>

We Solve The Lab !!

<figure><img src="../../../.gitbook/assets/image (478).png" alt=""><figcaption></figcaption></figure>
