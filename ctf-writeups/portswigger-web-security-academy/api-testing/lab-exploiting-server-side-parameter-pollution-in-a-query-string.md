---
description: To solve the lab, log in as the administrator and delete carlos.
---

# Lab: Exploiting server-side parameter pollution in a query string

First On The Burp Proxy and Capture All The Traffic In Burpsuite !!

<figure><img src="../../../.gitbook/assets/image (424).png" alt=""><figcaption></figcaption></figure>

Then We See The Request And We Got forgotpassword.js and We Got `/forgot-password?reset_token=${resetToken}` This Endpoint !!

<figure><img src="../../../.gitbook/assets/image (425).png" alt=""><figcaption></figcaption></figure>

This Is Our Forget Password Request !!

<figure><img src="../../../.gitbook/assets/image (426).png" alt=""><figcaption></figcaption></figure>

Send the request. Notice that this returns a `Field not specified` error message. This suggests that the server-side query may include an additional parameter called `field`, which has been removed by the `#` character.

<figure><img src="../../../.gitbook/assets/image (427).png" alt=""><figcaption></figcaption></figure>

Add a `field` parameter with an invalid value to the request. Truncate the query string after the added parameter-value pair. For example, add URL-encoded `&field=x`:

`username=administrator%26field=x`

<figure><img src="../../../.gitbook/assets/image (429).png" alt=""><figcaption></figcaption></figure>

In **Proxy > HTTP history**, notice the `POST /forgot-password` request and the related `/static/js/forgotPassword.js` JavaScript file.

<figure><img src="../../../.gitbook/assets/image (428).png" alt=""><figcaption></figcaption></figure>

In the **Repeater** tab, change the value of the `field` parameter from `x` to `reset_token`:

`username=administrator%26field=reset_token`

Send the request. Notice that this returns a password reset token. Make a note of this.

<figure><img src="../../../.gitbook/assets/image (430).png" alt=""><figcaption></figcaption></figure>

Then We Go On The Reset Token Endpoint and Paste The Token and We Got The Set Password Functionality and Set The Password of Administrator and Login To  The Administrator Account !!

<figure><img src="../../../.gitbook/assets/image (431).png" alt=""><figcaption></figcaption></figure>

&#x20;Login To  The Administrator Account !!

<figure><img src="../../../.gitbook/assets/image (432).png" alt=""><figcaption></figcaption></figure>

Delete The User Carlos To Solve The Lab !!

<figure><img src="../../../.gitbook/assets/image (433).png" alt=""><figcaption></figcaption></figure>

Finally We Complete The Lab after Delete The Carlos Account !!

<figure><img src="../../../.gitbook/assets/image (434).png" alt=""><figcaption></figcaption></figure>
