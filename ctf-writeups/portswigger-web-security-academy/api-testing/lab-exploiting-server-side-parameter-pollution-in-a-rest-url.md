---
description: To solve the lab, log in as the administrator and delete carlos.
---

# Lab: Exploiting server-side parameter pollution in a REST URL

First On The Burp Proxy and Capture All The Traffic In Burpsuite !!

In **Proxy > HTTP history**, notice the `POST /forgot-password` request and the related `/static/js/forgotPassword.js` JavaScript file.

<figure><img src="../../../.gitbook/assets/image (9) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

We Also Have a POST Request Send To The Repeater and Play With Them !!

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

We Add The same Username Parameter and It's Work !!

<figure><img src="../../../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

When We Add `#` This Is Invalid Route !!

<figure><img src="../../../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

At this level, add some common API definition filenames to the URL path. For example, submit the following:

`username=../../../../openapi.json%23`

Notice that this returns an error message, which contains the following API endpoint for finding users:

`/api/internal/v1/users/{username}/field/{field}`

Notice that this endpoint indicates that the URL path includes a parameter called `field`.

<figure><img src="../../../.gitbook/assets/image (4) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Using the `/api/` endpoint that you identified earlier, change the version of the API in the value of the `username` parameter:

`username=../../v1/users/administrator/field/passwordResetToken%23`

<figure><img src="../../../.gitbook/assets/image (5) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

In Burp's browser, enter the password reset endpoint in the address bar. Add your password reset token as the value of the `reset_token` parameter. For example:

`/forgot-password?passwordResetToken=123456789`

<figure><img src="../../../.gitbook/assets/image (6) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

* Set a new password.
* Log in as the `administrator` using your password.
* Go to the **Admin panel** and delete `carlos` to solve the lab.

<figure><img src="../../../.gitbook/assets/image (7) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Finally We Solve The Lab !!

<figure><img src="../../../.gitbook/assets/image (8) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>
