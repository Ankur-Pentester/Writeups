---
description: >-
  This lab contains an OS command injection vulnerability that can be exploited
  via its APIs. You can call these APIs via the LLM. To solve the lab, delete
  the morale.txt file from Carlos' home director
---

# Lab: Exploiting vulnerabilities in LLM APIs

We have a Live Chat Functionality Let's Try Some Prompt Injection and Solve The Lab !!

We Find The Three api Functions !!

1. `functions.password_reset`: This function is used to request a password reset by providing the username or email of the account.
2. `functions.subscribe_to_newsletter`: This function is used to subscribe to our newsletter by providing the email address.
3. `functions.product_info`: This function is used to get information about the products we sell by providing the name or ID of the product.

<figure><img src="../../../.gitbook/assets/image (17).png" alt=""><figcaption></figcaption></figure>

Let's Ask The  AI more about This  `subscribe_to_newsletter`  function !!

The `subscribe_to_newsletter` API function allows you to subscribe to our newsletter by providing your email address. The result will be a status message indicating whether the subscription was successful.

<figure><img src="../../../.gitbook/assets/image (18).png" alt=""><figcaption></figcaption></figure>

Let's Use Email Server !!

<figure><img src="../../../.gitbook/assets/image (19).png" alt=""><figcaption></figcaption></figure>

Let's Use The `subscribe_to_newsletter` API function and Try To RCE / OS COMMAND INJECTION  !!

<figure><img src="../../../.gitbook/assets/image (20).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

Let's Find The Current Directory and File also morale.txt and delete the file !!

<figure><img src="../../../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (23).png" alt=""><figcaption></figcaption></figure>

Let's Delete The File Using The Linux Command !!

<figure><img src="../../../.gitbook/assets/image (24).png" alt=""><figcaption></figcaption></figure>
