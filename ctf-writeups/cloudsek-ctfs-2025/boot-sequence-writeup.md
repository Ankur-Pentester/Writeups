# Boot Sequence ( Writeup )

<figure><img src="../../.gitbook/assets/image (135).png" alt=""><figcaption></figcaption></figure>

Upon opening the challenge, a web endpoint was provided:

{% embed url="http://15.206.47.5:8443/" %}

<figure><img src="../../.gitbook/assets/image (136).png" alt=""><figcaption></figcaption></figure>

During initial analysis, the page source was reviewed using the browser’s view-source feature. Multiple client-side JavaScript files were identified, including secrets.js, which indicated that sensitive logic was exposed on the frontend. This discovery guided further analysis toward client-side authorization and logic flaws.

<figure><img src="../../.gitbook/assets/image (137).png" alt=""><figcaption></figcaption></figure>

While reviewing the file /static/js/secrets.js, hardcoded operator credentials were discovered directly in the client-side source code. These credentials belonged to an active operator account and were used to authenticate successfully, leading to further access and challenge completion.

<figure><img src="../../.gitbook/assets/image (138).png" alt=""><figcaption></figcaption></figure>

The following hardcoded operator credentials discovered in `secrets.js` were used to authenticate successfully:

* **Username:** `flightoperator`
* **Password:** `GlowCloud!93`

This login resulted in direct access to the restricted **`/console`** endpoint.

<figure><img src="../../.gitbook/assets/image (139).png" alt=""><figcaption></figcaption></figure>

After successful authentication, a JWT-based session token (orbitalToken) was issued and stored in the browser’s storage. This token confirmed authenticated operator access and was used by the application to maintain the active session on the /console endpoint.

<figure><img src="../../.gitbook/assets/image (140).png" alt=""><figcaption></figcaption></figure>

The issued JWT token was decoded using the official JWT debugging tool. The token contents were readable; however, the signature validation failed, indicating an invalid signature. This confirmed that the token was signed using a secret key, which would be required to fully verify or manipulate the token.

<figure><img src="../../.gitbook/assets/image (141).png" alt=""><figcaption></figcaption></figure>

The JWT token was further analyzed using an online JWT auditing platform. By performing a secret brute-force attack, the signing key was successfully recovered, revealing the secret value butterfly, which enabled full token validation and further exploitation.

<figure><img src="../../.gitbook/assets/image (142).png" alt=""><figcaption></figcaption></figure>

Using the recovered JWT signing secret (`butterfly`), the token payload was modified by changing the role from **operator** to **admin**, and a new valid JWT was generated. This forged token enabled elevated privileges within the application.

<figure><img src="../../.gitbook/assets/image (143).png" alt=""><figcaption></figcaption></figure>

After generating the forged admin JWT, the token was replaced in browser storage and the page was reloaded. Upon reload, the application accepted the modified token, confirming elevated (admin-level) access.

<figure><img src="../../.gitbook/assets/image (144).png" alt=""><figcaption></figcaption></figure>

After replacing the session token and reloading the application, admin-level access was successfully granted. The Admin Beacon functionality became available, confirming full administrative privileges within the Orbital Control Deck.

<figure><img src="../../.gitbook/assets/image (145).png" alt=""><figcaption></figcaption></figure>

Within the Admin Beacon panel, a checksum was generated and a Server-Side Template Injection (SSTI) payload (`{{7*7}}`) was submitted. The application evaluated the expression and returned **49**, confirming successful SSTI execution with admin privileges.

The checksum was generated by analyzing the `console.js` file and invoking the exposed client-side function `hyperpulseChecksum()`, using the admin message input and the active session token (`orbitalToken`) as parameters.

```
hyperpulseChecksum( document.getElementById("admin-message").value,
sessionStorage.getItem("orbitalToken")
)
```

<figure><img src="../../.gitbook/assets/image (146).png" alt=""><figcaption></figcaption></figure>

After regenerating a valid checksum, an advanced SSTI payload was injected to execute system commands. The payload successfully executed the id command, returning uid=0 (root), confirming root-level command execution and full system compromise.

```
{{ self._TemplateReference__context.cycler.init.globals.os.popen('id').read() }}
```

<figure><img src="../../.gitbook/assets/image (147).png" alt=""><figcaption></figcaption></figure>

After generating a valid checksum once again, an SSTI payload was used to read the root flag file. The command executed successfully, and the final flag was retrieved, completing the challenge.

```
{{ self._TemplateReference__context.cycler.init.globals.os.popen('cat /root/flag.txt').read() }}
```

<figure><img src="../../.gitbook/assets/image (148).png" alt=""><figcaption></figcaption></figure>

```
Flag: ClOuDsEk_ReSeArCH_tEaM_CTF_2025{997c4f47961b43ceaf327e08bc45ad0b}
```
